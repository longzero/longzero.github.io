---
layout: layouts/map.njk
description: Camping map
title: Camping map
templateClass: tmpl-post
eleventyNavigation:
  key: Camping map
  order: 3
---

<style>
  body {--header-height: 40px;}
  .leaflet-container {font-size: 1rem;}
  .leaflet-control-attribution {font-size: 1em; transform: scale(.7); transform-origin: right bottom; transition: .3s; max-width: 320px; width: 100%;}
  .leaflet-control-attribution:hover {transform: scale(1);}

  .leaflet-popup-content {margin: 0; padding: 1em 1em;}
  .leaflet-popup-content p {margin: 0 0 1em;}
  .leaflet-popup-content p:last-child {margin: 0;}
  .leaflet-popup-content-wrapper {border-radius: 5px; padding: 0;}

  .location-tooltip-action {display: inline-block; font-size: .85em; margin-top: var(--tooltip-content-spacing); text-overflow: ellipsis; white-space: nowrap; max-width: 100%; overflow: hidden;}
  .location-tooltip-content {--tooltip-content-spacing: 1em; font-size: .9rem;}
  .location-tooltip-name, .leaflet-container .location-tooltip-name {color: inherit; display: block; font-size: 1rem; font-weight: 700; margin-bottom: var(--tooltip-content-spacing); text-decoration: none; transition: .3s;}
  .location-tooltip-name:hover, .leaflet-container .location-tooltip-name:hover {color: var(--color-1);}
  .location-tooltip-name:not(:only-child) {margin-bottom: var(--tooltip-content-spacing);}

  .map-legend {font-size: .85rem; position: absolute; top: var(--header-height); right: 0;
    z-index: 400; /* Don't know why it was to be over 399 to be visible above the map */
  }
  .map-legend ul, .map-legend-heading {background-color: rgba(255,255,255,.8); padding: 20px;}
  .map-legend ul {list-style: none; padding-top: 0; padding-bottom: .5em; transition: .3s;}
  .map-legend li {margin-bottom: .5em; white-space: nowrap;}
  .map-legend-heading {cursor: pointer;}
  .map-legend-symbol, .map-legend-value {display: inline-block; vertical-align: top;}
  .map-legend-symbol {margin-right: 10px; width: 16px;}
  .map-legend.minimize ul {opacity: 0; pointer-events: none; transform: translateY(-100%);}
  .map-wrapper, .tmpl-post {height: calc(100vh - var(--header-height));}
  .map-wrapper {width: 100%;}
  .site-header {margin-bottom: 0;}
</style>


<div class="map-wrapper" id="map"></div>
<div class="map-legend" id="map-legend">
  <h4 class="map-legend-heading js-legend-toggle">Legend</h4>
  <ul>
    <li>
      <div class="map-legend-symbol"><img src="/assets/images/map-icons/marker-icon-campspot.svg" alt=""></div>
      <div class="map-legend-value">Campspot</div>
    </li>
    <li>
      <div class="map-legend-symbol"><img src="/assets/images/map-icons/marker-icon-place.svg" alt=""></div>
      <div class="map-legend-value">Random place</div>
    </li>
    <li>
      <div class="map-legend-symbol"><img src="/assets/images/map-icons/marker-icon-water.svg" alt=""></div>
      <div class="map-legend-value">Place to get water</div>
    </li>
  </ul>
</div>


<script>

  // TOGGLE LEGEND
  document.querySelector('.js-legend-toggle').addEventListener('click', function() {
    this.parentNode.classList.toggle('minimize')
  })


  // MAP MARKER ICONS
  const markerPathCampspot = '/assets/images/map-icons/marker-icon-campspot.svg'
  const markerPathPlace = '/assets/images/map-icons/marker-icon-place.svg'
  const markerPathWater = '/assets/images/map-icons/marker-icon-water.svg'


  // You have tried using SVG, but there is an issue with zooming:
  // When zooming, the marker shifts.
  const svgDefault = L.icon({
    iconUrl: markerPathCampspot,
    className: "marker-icon",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  let svgIcon = L.icon({
    // Green: #3AAD64
    iconUrl: markerPathCampspot,
    className: "marker-icon",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  const svgPlace = L.icon({
    iconUrl: markerPathPlace,
    className: "marker-icon marker-icon--place",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  const svgWater = L.icon({
    iconUrl: markerPathWater,
    className: "marker-icon marker-icon--water",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });
  // END MAP MARKER ICONS


  function initMap(locations) {
    // console.log(locations)

    // This is the code to start the map at a specific location.
    // var map = L.map('map').setView([38.973268454455706, -105.03998309979006], 14);

      // [50.881052232075994, -128.35989413555518],
      // [18.178802320423507, -66.31842310872378]


    var map = L.map('map', {
      // https://github.com/mutsuyuki/Leaflet.SmoothWheelZoom
      scrollWheelZoom: false, // disable original zoom function
      smoothWheelZoom: true,  // enable smooth zoom
      smoothSensitivity: 8,   // zoom speed. default is 1
      // END https://github.com/mutsuyuki/Leaflet.SmoothWheelZoom
    }).fitBounds([
      [54.14584949174648, -128.75881463815347],
      [17.055714221336178, -59.9846634648619]
    ])
    L.control.scale().addTo(map);
    mapLink = '<a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>';
    L.tileLayer(
      'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'This map is personal and contains places where I have been with my personal impression. Thatâ€™s all.',
        maxZoom: 20
      }).addTo(map);

    // console.log(locations.campspots.length)
    // if (typeof locations === 'object' && locations !== null) {
    //   console.log("It's an object")
    // }
    for (let key in locations) {
      // Change marker icon depending on type of location.
      switch(key) {
        case "places":
          svgIcon = svgPlace
          break
        case "water":
          svgIcon = svgWater
          break
        default:
          svgIcon = svgDefault
      }

      // Loop through locations and add them to the map.
      for (let key2 in locations[key]) {
        let location = locations[key][key2]

        // Check if location should be on the map and obviously, make sure there are coordinates.
        if (location.visible !== 0 && location.latitude && location.longitude) {

          let locationName = "",
              locationNotes = "",
              locationUrl = ""

          // Create URL to Google Maps from coordinates.
          let googleMapsUrl = "https://www.google.com/maps/search/?api=1&query=" + location.latitude + "%2C" + location.longitude

          // If there is no name, create it from coordinates.
          if (location.name == undefined) locationName = location.latitude + ", " + location.longitude
          else locationName = location.name
          locationName = '<a class="location-tooltip-name" href="' + googleMapsUrl + '" target="_blank">' + locationName + '</a>'

          // Check other content
          if (location.notes !== undefined && location.notes !== "") locationNotes = '<div class="location-tooltip-notes">' + location.notes + '</div>'
          if (location.url !== undefined && location.url !== "") locationUrl = '<a class="location-tooltip-action" target="_blank" href="' + location.url + '">' + location.url + '</a>'

          // Build the content of tooltips.
          let locationContent = '<div class="location-tooltip-content">' + locationName + locationNotes + locationUrl + '</div>'

          // Place markers on the map.
          marker = new L.marker([location.latitude, location.longitude], {icon: svgIcon})
            .bindPopup(locationContent, { offset: L.point(0,-14) })
            .addTo(map);
        }
      }
    }
  }



  // https://stackoverflow.com/a/34579496/2716287
  function loadJSON(file, callback) {
      var rawFile = new XMLHttpRequest();
      rawFile.overrideMimeType("application/json");
      rawFile.open("GET", file, true);
      rawFile.onreadystatechange = function() {
          if (rawFile.readyState === 4 && rawFile.status == "200") {
              callback(rawFile.responseText);
          }
      }
      rawFile.send(null);
  }

  loadJSON("/assets/js/map/camping-locations.json", function(text){
    data = JSON.parse(text);
    initMap(data)
  });
  // END https://stackoverflow.com/a/34579496/2716287


  </script>
