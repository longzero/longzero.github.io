---
layout: layouts/map.njk
description: Camping map
title: Camping map
templateClass: tmpl-post
eleventyNavigation:
  key: Camping map
  order: 3
---

<style>
  .leaflet-container {font-size: 1rem;}
  .leaflet-control-attribution {font-size: 1em; transform: scale(.7); transform-origin: right bottom; transition: .3s; max-width: 320px; width: 100%;}
  .leaflet-control-attribution:hover {transform: scale(1);}

  .leaflet-popup-content {margin: 0; padding: 1em 1em;}
  .leaflet-popup-content p {margin: 0 0 1em;}
  .leaflet-popup-content p:last-child {margin: 0;}
  .leaflet-popup-content-wrapper {border-radius: 5px; padding: 0;}

  .location-tooltip-content {--tooltip-content-spacing: .5em; font-size: .9rem;}
  .location-tooltip-link {display: block; margin-top: var(--tooltip-content-spacing); text-overflow: ellipsis; max-width: 100%; overflow: hidden;}
  .location-tooltip-name {font-size: 1rem; font-weight: 700;}
  .location-tooltip-name:not(:only-child) {margin-bottom: var(--tooltip-content-spacing);}

  .map-wrapper, .tmpl-post {height: calc(100vh - 40px);}
  .map-wrapper {width: 100%;}
  .site-header {margin-bottom: 0;}
</style>


<div class="map-wrapper" id="map"></div>


<script>


  // MAP MARKER ICONS
  // You have tried using SVG, but there is an issue with zooming:
  // When zooming, the marker shifts.
  const svgDefault = L.icon({
    iconUrl: '/assets/images/map-icons/marker-icon-campspot.svg',
    className: "marker-icon",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  let svgIcon = L.icon({
    // Green: #3AAD64
    iconUrl: '/assets/images/map-icons/marker-icon-campspot.svg',
    className: "marker-icon",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  const svgPlace = L.icon({
    iconUrl: '/assets/images/map-icons/marker-icon-place.svg',
    className: "marker-icon marker-icon--place",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });

  const svgWater = L.icon({
    iconUrl: '/assets/images/map-icons/marker-icon-water.svg',
    className: "marker-icon marker-icon--water",
    iconSize: [24,32],
    iconAnchor: [12,31]
  });
  // END MAP MARKER ICONS


  function initMap(locations) {
    // console.log(locations)

    // This is the code to start the map at a specific location.
    // var map = L.map('map').setView([38.973268454455706, -105.03998309979006], 14);


    var map = L.map('map', {
      // https://github.com/mutsuyuki/Leaflet.SmoothWheelZoom
      scrollWheelZoom: false, // disable original zoom function
      smoothWheelZoom: true,  // enable smooth zoom
      smoothSensitivity: 4,   // zoom speed. default is 1
      // END https://github.com/mutsuyuki/Leaflet.SmoothWheelZoom
    }).fitBounds([
      [50.881052232075994, -128.35989413555518],
      [18.178802320423507, -66.31842310872378]
    ])
    L.control.scale().addTo(map);
    mapLink = '<a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>';
    L.tileLayer(
      'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'This map is personal and contains places where I have been with my personal impression. Thatâ€™s all.',
        maxZoom: 20
      }).addTo(map);

    // console.log(locations.campspots.length)
    // if (typeof locations === 'object' && locations !== null) {
    //   console.log("It's an object")
    // }
    for (let key in locations) {
      // Change marker icon depending on type of location.
      switch(key) {
        case "places":
          svgIcon = svgPlace
          break
        case "water":
          svgIcon = svgWater
          break
        default:
          svgIcon = svgDefault
      }

      // Loop through locations and add them to the map.
      for (let key2 in locations[key]) {
        let location = locations[key][key2]
        if (location.visible !== 0) {
          // console.log(location.visible)
          let locationName = "",
              locationNotes = "",
              locationUrl = ""
          if (location.name.length) locationName = '<div class="location-tooltip-name">' + location.name + '</div>'
          if (location.notes.length) locationNotes = '<div class="location-tooltip-notes">' + location.notes + '</div>'
          if (location.url.length) locationUrl = '<a class="location-tooltip-link" target="map-location" href="' + location.url + '">' + location.url + '</a>'
          let locationContent = '<div class="location-tooltip-content">' + locationName + locationNotes + locationUrl + '</div>'
          marker = new L.marker([location.latitude, location.longitude], {icon: svgIcon})
            .bindPopup(locationContent, { offset: L.point(0,-14) })
            .addTo(map);
        }
      }
    }
  }



  // https://stackoverflow.com/a/34579496/2716287
  function loadJSON(file, callback) {
      var rawFile = new XMLHttpRequest();
      rawFile.overrideMimeType("application/json");
      rawFile.open("GET", file, true);
      rawFile.onreadystatechange = function() {
          if (rawFile.readyState === 4 && rawFile.status == "200") {
              callback(rawFile.responseText);
          }
      }
      rawFile.send(null);
  }

  loadJSON("/assets/js/map/camping-locations.json", function(text){
    data = JSON.parse(text);
    initMap(data)
  });
  // END https://stackoverflow.com/a/34579496/2716287


  </script>
